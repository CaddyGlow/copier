name: CI

on:
  push:
    branches: [ "main" ]
    tags: [ "v*" ]
  pull_request:
  workflow_dispatch:
    inputs:
      force_release:
        description: 'Force a release (even without a tag)'
        required: false
        type: boolean
        default: false

permissions:
  contents: write

jobs:
  ci:
    uses: CaddyGlow/homebrew-packages/.github/workflows/rust-ci.yml@main
    with:
      binaries: '["quickctx"]'
      assets: '["README.md"]'
      test_command: 'cargo test --all-features'
      clippy_args: '--all-targets --all-features'
      force_release: ${{ github.event.inputs.force_release == 'true' }}
